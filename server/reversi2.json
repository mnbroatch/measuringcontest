{
  "entities": [
    {
      "name": "mainGrid",
      "type": "Grid",
      "width": 3,
      "height": 1
    },
    {
      "name": "disc",
      "state": { "player": "0" },
      "count": "Infinity"
    }
  ],
  "sharedBoard": [{ "name": "mainGrid" }],
  "initialPlacements": [
    {
      "entity": {
        "name": "disc",
        "state": { "player": "0" }
      },
      "destination": { "index": 0 }
    },
    {
      "entity": {
        "name": "disc",
        "state": { "player": "1" }
      },
      "destination": { "index": 1 }
    }
  ],
  "minPlayers": 2,
  "maxPlayers": 2,
  "turn": {
    "minMoves": 1,
    "maxMoves": 1,
    "passIfNoMoves": true
  },
  "moves": {
    "inRootDummy": {
      "type": "PlaceNew",
      "arguments": {
        "destination": {}
      },
      "entity": {
        "state": { "player": "CurrentPlayer" },
        "conditions": [{
          "type": "Is",
          "matcher": { "name": "disc" }
        }]
      }
    }
  },
  "phases": {
    "mlah": {
      "moves": {
        "inOtherPhaseDummy": {
          "type": "PlaceNew",
          "arguments": {},
          "entity": {
            "state": { "player": "CurrentPlayer" },
            "conditions": [{
              "type": "Is",
              "matcher": { "name": "disc" }
            }]
          }
        }
      },
      "turn": {
        "stages": {
          "sdasd": {
            "moves": {
              "inOtherPhaseAndStageDummy": {
                "type": "PlaceNew",
                "arguments": {},
                "entity": {
                  "state": { "player": "CurrentPlayer" },
                  "conditions": [{
                    "type": "Is",
                    "matcher": { "name": "disc" }
                  }]
                }
              }
            }
          }
        }
      }
    },
    "blah": {
      "start": true,
      "moves": {
        "inPhaseDummy": {
          "type": "PlaceNew",
          "arguments": {},
          "entity": {
            "state": { "player": "CurrentPlayer" },
            "conditions": [{
              "type": "Is",
              "matcher": { "name": "disc" }
            }]
          }
        }
      },
      "turn": {
        "minMoves": 1,
        "maxMoves": 1,
        "passIfNoMoves": true,
        "activePlayers": { "currentPlayer": "bleh" },
        "stages": {
          "bluh": {
            "moves": {
              "inOtherStageDummy": {
                "type": "PlaceNew",
                "arguments": {},
                "entity": {
                  "state": { "player": "CurrentPlayer" },
                  "conditions": [{
                    "type": "Is",
                    "matcher": { "name": "disc" }
                  }]
                }
              }
            }
          },
          "bleh": {
            "moves": {
              "placeDisc": {
                "type": "PlaceNew",
                "entity": {
                  "state": { "player": "CurrentPlayer" },
                  "conditions": [{
                    "type": "Is",
                    "matcher": { "name": "disc" }
                  }]
                },
                "arguments": {
                  "destination": {
                    "playerChoice": true,
                    "conditions": [
                      {
                        "type": "Is",
                        "matcher": { "type": "Space" }
                      },
                      {
                        "type": "Not",
                        "conditions": [{ "type": "Contains" }]
                      },
                      {
                        "type": "Would",
                        "conditions": [{
                          "type": "InLine",
                          "sequence": [
                            {
                              "conditions": [{
                                "type": "Contains",
                                "conditions": [{
                                  "type": "Is",
                                  "matcher": {
                                    "player": "CurrentPlayer"
                                  }
                                }]
                              }]
                            },
                            {
                              "minCount": 1,
                              "conditions": [
                                {
                                  "type": "Not",
                                  "conditions": [{
                                    "type": "Contains",
                                    "conditions": [{
                                      "type": "Is",
                                      "matcher": {
                                        "player": "CurrentPlayer"
                                      }
                                    }]
                                  }]
                                },
                                {
                                  "type": "ContainsSame",
                                  "properties": ["player"]
                                }
                              ]
                            },
                            {
                              "conditions": [{
                                "type": "Contains",
                                "conditions": [{
                                  "type": "Is",
                                  "matcher": {
                                    "player": "CurrentPlayer"
                                  }
                                }]
                              }]
                            }
                          ]
                        }]
                      }
                    ]
                  }
                },
                "then": [{
                  "type": "ForEach",
                  "arguments": {
                    "targets": {
                      "contextPath": [
                        "moveConditionResults",
                        0,
                        "conditionResults",
                        "destination",
                        "results",
                        2,
                        "results",
                        0,
                        "matches",
                        { "flatten": true, "map": ["entities"] },
                        { "flatten": true }
                      ]
                    }
                  },
                  "move": {
                    "type": "SetState",
                    "arguments": {
                      "entity": {
                        "contextPath": [ "loopTarget" ]
                      },
                      "state": {
                        "property": "player",
                        "value": "CurrentPlayer"
                      }
                    }
                  }
                }]
              }
            }
          }
        }
      }
    }
  },
  "endIf": [
    {
      "conditions": [{
        "type": "Evaluate",
        "expression": "passCount == numPlayers",
        "arguments": {
          "passCount": {
            "gamePath": ["meta", "passCount"]
          },
          "numPlayers": {
            "ctxPath": ["playOrder", "length"]
          }
        }
      }],
      "result": {
        "winners": {
          "mapMax": {
            "targets": {
              "ctxPath": ["playOrder"]
            },
            "mapping": {
              "type": "count",
              "conditions": [{
                "type": "Is",
                "matcher": {
                  "player": { "contextPath": [ "loopTarget" ] }
                }
              }]
            }
          }
        }
      }
    }
  ]
}
